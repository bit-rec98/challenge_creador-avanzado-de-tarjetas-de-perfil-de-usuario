<div class="container">
  <header>
    <h1>Tarjetas de perfiles de usuarios</h1>
    <div class="search-sort-container">

      <!-- Contenedor de búsqueda -->
      <div class="search-container">
        <input
          type="text"
          [(ngModel)]="searchTerm"
          (input)="onSearch()"
          placeholder="Buscar por nombre o país..."
          class="search-input"
        />
      </div>

      <!-- Contenedor de ordenación -->
      <div class="sort-container">
        <select
          [(ngModel)]="sortOption"
          (change)="onSortChange()"
          class="sort-select"
        >
          <option value="none">Ordenar por...</option>
          <option value="nameAsc">Nombre (A-Z)</option>
          <option value="nameDesc">Nombre (Z-A)</option>
          <option value="country">País</option>
        </select>
      </div>

      <!-- Contenedor de acciones -->
      <div class="action-buttons" *ngIf="!isLoading">
        <button
          (click)="generateNewProfile()"
          class="generate-button"
          [disabled]="isLoading || isGeneratingSingle"
        >
          {{ isGeneratingSingle ? "Generando..." : "Generar nuevo perfil" }}
        </button>
      </div>
    </div>
  </header>

  <!-- Mensaje de error -->
  <div *ngIf="error" class="error-message">
    {{ error }}
  </div>

  <!-- Spinner de carga -->
  <div *ngIf="isLoading" class="content-overlay">
    <app-spinner [message]="loadingMessage"></app-spinner>
  </div>

  <!-- Grid de usuarios -->
  <div class="user-grid" *ngIf="!isLoading">
    <app-user-card
      *ngFor="let user of filteredUsers; let i = index"
      [user]="user"
      (cardClick)="openUserDetails(user)"
      class="user-grid-item"
      [attr.data-index]="i"
    ></app-user-card>
  </div>

  <div
    *ngIf="filteredUsers.length === 0 && !isLoading && !isGeneratingSingle"
    class="no-results"
  >
    <p>
      No se encontraron usuarios que coincidan con tus criterios de búsqueda.
    </p>
  </div>

  <div class="load-more-container" *ngIf="!isLoading">
    <button
      (click)="loadMoreUsers()"
      class="load-more-button"
      [disabled]="isLoading"
    >
      {{ isLoading ? "Cargando..." : "Cargar más perfiles" }}
    </button>
  </div>

  <!-- Modal de detalles del usuario -->
  <app-user-detail-modal
    [user]="selectedUser"
    (closeModal)="closeUserDetails()"
  ></app-user-detail-modal>
</div>
